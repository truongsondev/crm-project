<div class="mt-6 mx-10 bg-white">
  <div class="flex flex-col gap-6">
    <div class="flex flex-col gap-10">
      <div class="flex gap-20 items-center">
        <h1 class="font-medium text-4xl">User management</h1>
        <div
          mat-button
          (click)="openDialog()"
          class="cursor-pointer flex items-center justify-center gap-2 w-[130px] h-[35px] bg-primary rounded-[10px] text-white font-medium"
        >
          <mat-icon class="text-white cursor-pointer" [style.color]="'white'"
            >add</mat-icon
          >
          <button class="cursor-pointer">Add User</button>
        </div>
      </div>
      <div class="flex justify-between items-center">
        <h1 class="font-medium text-xl">List of Users</h1>
        <div class="relative">
          <select
            class="rounded px-4 py-2 w-50 shadow-lg"
            (change)="getUserByRole($event)"
          >
            <option value="">Role</option>
            <option
              *ngFor="let item of displayRole | keyvalue"
              [value]="item.key"
            >
              {{ item.value }}
            </option>
          </select>
        </div>
        <div class="relative">
          <mat-form-field>
            <mat-label>Created time</mat-label>
            <mat-date-range-input
              [rangePicker]="createdPicker"
              [formGroup]="range"
            >
              <input
                formControlName="start"
                matStartDate
                placeholder="Start date"
              />
              <input
                (dateChange)="getUserByTime()"
                formControlName="end"
                matEndDate
                placeholder="End date"
              />
            </mat-date-range-input>
            <mat-datepicker-toggle
              matIconSuffix
              [for]="createdPicker"
            ></mat-datepicker-toggle>
            <mat-date-range-picker #createdPicker></mat-date-range-picker>
            @if (range.controls.start.hasError("matStartDateInvalid")) {
              <mat-error>Invalid start date</mat-error>
            }
            @if (range.controls.end.hasError("matEndDateInvalid")) {
              <mat-error>Invalid end date</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="relative">
          <mat-form-field>
            <mat-label>Updated time</mat-label>
            <mat-date-range-input
              [rangePicker]="updatedPicker"
              [formGroup]="range"
            >
              <input
                matStartDate
                placeholder="Start date"
                formControlName="start"
              />
              <input
                matEndDate
                placeholder="End date"
                formControlName="end"
                (dateChange)="getUserByTime()"
              />
            </mat-date-range-input>
            <mat-datepicker-toggle
              matIconSuffix
              [for]="updatedPicker"
            ></mat-datepicker-toggle>
            <mat-date-range-picker #updatedPicker></mat-date-range-picker>
            @if (range.controls.start.hasError("matStartDateInvalid")) {
              <mat-error>Invalid start date</mat-error>
            }
            @if (range.controls.end.hasError("matEndDateInvalid")) {
              <mat-error>Invalid end date</mat-error>
            }
          </mat-form-field>
        </div>

        <div>
          <search-component
            (search)="onSearch($event)"
            [titleSearch]="mySearch"
          />
        </div>
      </div>

      <div>
        <div class="mat-elevation-z8">
          <table mat-table [dataSource]="dataSource" matSort class="">
            <ng-container
              *ngFor="let col of columnDefs"
              [matColumnDef]="col.column"
            >
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{ col.label }}
              </th>
              <td mat-cell *matCellDef="let row">
                <ng-container [ngSwitch]="col.column">
                  <span
                    class="text-primary cursor-pointer"
                    *ngSwitchCase="'action'"
                    (click)="onRowClick(row)"
                    >Edit</span
                  >
                  <span *ngSwitchCase="'employee'">
                    {{ row["first_name"] }} {{ row["last_name"] }}
                  </span>
                  <span *ngSwitchCase="'role'">
                    {{ getDisplayRole(row.role) }}
                  </span>
                  <span *ngSwitchCase="'all'">
                    <p>
                      <mat-checkbox></mat-checkbox>
                    </p>
                  </span>
                  <span *ngSwitchCase="'manager_name'">
                    {{ row.manager_name?.name || "-" }}
                  </span>
                  <span *ngSwitchDefault>
                    {{ row[col.column] || "-" }}
                  </span>
                </ng-container>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="4">
                No data matching the filter CONSTANT CHỖ NÀY
              </td>
            </tr>
          </table>

          <mat-paginator
            [pageSizeOptions]="[10]"
            aria-label="Select page of users"
          ></mat-paginator>
        </div>
      </div>
    </div>
  </div>
</div>
